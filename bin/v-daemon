#!/usr/bin/env node

/**
 * Command line interface of v-daemon.
 * This file is auto generated by ape-tmpl.
 */

'use strict'

const program = require('commander')
const pkg = require('../package')
const vDaemon = require('../lib')

program
  .version(pkg[ 'version' ])
  .usage('[options] <filename ...> ')
  .description(pkg[ 'description' ])
  .option('-H, --hostname [hostname]', 'List available tasks')
  .option('-p, --port [port]', 'Port number')
  .option('-P, --protocol [protocol]', 'Protocol')
  .option('-c, --connector [connector]', 'connection type')
  .option('-i, --id [id]', 'Subject ID')
  .option('-q, --quiet [quiet]', 'No messages')
  .option('-v, --verbose [verbose]', 'Show verbose log')
program.parse(process.argv)

// Run main command
vDaemon.apply(vDaemon, program.args.concat({
  hostname: program.hostname,
  port: program.port,
  protocol: program.protocol,
  connector: program.connector,
  id: program.id,
  quiet: program.quiet,
  verbose: program.verbose})
).catch(handleError)

// Handlers

/** Handle error */
function handleError (err) {
  console.error(err)
  process.exit(1)
}
